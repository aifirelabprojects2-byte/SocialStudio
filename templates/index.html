<!DOCTYPE html>
<html class="light" lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>AI Social Studio</title>
  <script src="/static/tailwind.js"></script>
  <link href="https://fonts.googleapis.com" rel="preconnect"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/static/PostAi.css">
  <link rel="stylesheet" href="/static/Nav.css">
  <link rel="stylesheet" href="/static/Scheduled.css">
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          fontFamily: {
            sans: ["Inter", "system-ui", "sans-serif"],
            display: ["Inter", "system-ui", "sans-serif"],
          },
          rotate: {
            '360': '360deg', 
          }
        },
      },
    }
  </script>
  <style>
    .ease-elastic {
      transition-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .ease-smooth {
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    }
    .skeletonPlatform-loader {
      background: linear-gradient(90deg,
        rgba(240, 240, 240, 0) 0%,
        rgba(240, 240, 240, 0.8) 50%,
        rgba(240, 240, 240, 0) 100%
      );
      background-size: 200% 100%;
      animation: skeletonPlatform-loading 1.8s ease-in-out infinite;
    }
  
    @keyframes skeletonPlatform-loading {
      0%   { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
  
    .skeletonPlatform-line {
      @apply h-4 bg-gray-200 rounded;
    }
  
    dialog::backdrop {
      @apply bg-black/50;
    }
  </style>
  <style>
    :root {
  
        --bg-body: #eef2f5; 
        --bg-app: #ffffff;
        --text-main: #1d1d1f; 
        --text-muted: #86868b;
        --accent: #0071e3; 
        --pill-color: #dddddde5; 
        --card-bg: #f2f2f7;
        --shadow-soft: 0 10px 40px rgba(0,0,0,0.08); 
    }


    body, html {
      font-family: "Plus Jakarta Sans", "system-ui", "sans-serif";
      font-feature-settings: "cv11", "ss01";
      font-weight: 400;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at 50% 50%, #ffffff 0%, #eef1f5 100%);
      height: 100vh;
      overflow: hidden;
      color: var(--text-main);
      width: 100%;
    }


</style>
</head>
<body class="bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100 min-h-screen flex flex-col transition-colors duration-200">
  <div class="app-container w-full">
    <nav class="nav-header">
      <div class="flex h-16 w-full items-center shadow-[0px_20px_20px_8px_white]">
          
          <div class="flex items-center gap-3 w-1/4">
              <div class="bg-gray-600 text-white p-1.5 rounded-lg">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>
              </div>
              <span class="font-semibold text-lg tracking-tight text-slate-900 dark:text-white">AI Social Studio</span>
          </div>
          
          <div class="flex-grow flex justify-center">
              <ul class="nav-list">
                  <div class="nav-pill"></div>
                  <li class="pill-nav-item active" data-index="0">Leads</li>
                  <li class="pill-nav-item" data-index="1">Competitors</li>
                  <li class="pill-nav-item" data-index="2">Mentions</li>
                  <li class="pill-nav-item" data-index="3">Engagement</li>
                  <li class="pill-nav-item" data-index="4">Campaigns</li>
              </ul>
          </div>
          
          <div class="flex items-center justify-end gap-4 w-1/4">
              <button class="p-2 text-gray-600 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 transition">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
              </button>
          </div>
          
      </div>
  </nav>

    <div class="viewport">
        <div class="content-track">
            
            <div class="tab-content">
              
                <main class="flex-grow w-full max-w-7xl  mx-auto px-4 sm:px-6 lg:px-8 py-10 space-y-12">
                  
                  <section class="max-w-3xl mx-auto" id="Section1">
                    <div class="text-center mb-8">
                        <h1 class="text-3xl md:text-4xl font-semibold tracking-tight text-slate-900 dark:text-white mb-3">
                            What would you like to post today?
                        </h1>
                        <p class="text-gray-600 dark:text-slate-400 text-lg">
                            Describe your idea, and we'll craft the caption, hashtags, and visuals.
                        </p>
                    </div>
                
                    <div id="OutergenerateForm" class="bg-white dark:bg-slate-800 rounded-3xl  border border-slate-200 dark:border-slate-700 p-1 transition-transform duration-300 ease-out has-[:focus]:scale-105">
                        <form id="generateForm" class="p-5 sm:p-6 space-y-4">
                            <div class="relative">
                                <textarea name="prompt" rows="3" required id="animatedPlaceholder" class="block w-full rounded-2xl border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-900/50 text-slate-900 dark:text-white shadow-sm focus:border-gray-500 focus:ring-gray-500 sm:text-base px-4 py-3 transition resize-none placeholder:text-slate-400" placeholder="">
                                </textarea>
                            </div>
                            <div class="flex items-center justify-between pt-2">
                                <div class="flex items-center space-x-4">

                                  <label for="imgToggle" title="Click to generate image prompt" class="flex items-center space-x-2  p-[7px]  text-sm font-medium transition duration-150 cursor-pointer select-none">
                                    <span class=" text-sm font-medium text-slate-700 dark:text-slate-300">
                                      Image Prompt
                                    </span>
                                    <div class="relative ml-3">
                                        <input type="checkbox" id="imgToggle" name="generate_image" value="yes" class="sr-only peer" checked>
                                        <div class="w-11 h-6 bg-gray-300 rounded-full transition peer-checked:bg-gray-800 dark:bg-slate-700"></div>
                                        <div class="absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition 
                                                    peer-checked:translate-x-5 shadow"></div>
                                    </div>
                                  </label>

                                  <div id="useCaseCarouselDrf" class="flex items-center space-x-2 rounded-2xl  dark:bg-slate-700 border border-slate-200 dark:border-slate-600 p-[6px] text-sm font-medium transition duration-150">
                                        
                                    <button type="button" id="prevCaseBtnDrf" title="Previous Use Case"
                                        class="text-slate-700 dark:text-slate-200 hover:text-gray-900 dark:hover:text-white disabled:opacity-50 transition p-1">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
                                    </button>
            
                                    <span id="currentCaseTextDrf" class="text-slate-700 dark:text-slate-200 whitespace-nowrap min-w-[110px] text-center">
                                        Custom Idea
                                    </span>
            
                                    <button type="button" id="nextCaseBtnDrf" title="Next Use Case"
                                        class="text-slate-700 dark:text-slate-200 hover:text-gray-900 dark:hover:text-white disabled:opacity-50 transition p-1">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>
                                    </button>
                                  </div>
                                

                                </div>
                
                                <button type="submit" id="genBtnBtn"
                                    class="shiny-button inline-flex items-center justify-center rounded-xl bg-gray-800 px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-gray-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600 transition-all duration-200">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7"></path><line x1="16" y1="5" x2="22" y2="5"></line><line x1="19" y1="2" x2="19" y2="8"></line></svg>
                                    <span id="genBtnSpan" >Generate Draft</span>
                                </button>
                            </div>
                        </form>
                    </div>
                
                    <div id="loading" class="hidden mt-8 text-center animate-pulse">
                        <div class="inline-flex items-center px-4 py-2 font-semibold leading-6 text-gray-600 transition ease-in-out duration-150 cursor-not-allowed">
                            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            Crafting your post...
                        </div>
                    </div>
                
                    <div id="preview" class="hidden mt-8 w-full bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-slate-200 dark:border-slate-700 overflow-hidden">
                    </div>
                </section>

                  <section class="min-h-[20rem] ">
                    <div class="flex mb-6 px-1">
                      <h2 class="text-2xl flex items-center font-semibold tracking-tight text-slate-900 dark:text-white w-full">
                        <div class="mr-3">Recent Drafts</div>
                        
                        <div id="draftCount" class="inline-flex items-center  rounded-full bg-slate-100 dark:bg-slate-700 px-2.5 py-0.5 text-sm font-medium text-slate-800 dark:text-slate-300">0</div>
                      </h2>
                    
                      <button onclick="loadDrafts()" class="refresh-button group text-gray-600 hover:text-gray-500">
                        <svg class="w-6 h-6 transition-transform duration-500 ease-out group-hover:rotate-360"  viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M13.5 4.5H12.5C8.08172 4.5 4.5 8.08172 4.5 12.5C4.5 15.6631 6.33576 18.3975 9 19.6958M11.5 20.5H12.5C16.9183 20.5 20.5 16.9183 20.5 12.5C20.5 9.33688 18.6642 6.60253 16 5.30423" stroke="currentColor" stroke-width="2"/>
                          <path d="M14 17.5619L11.5 20.5L14.5 23.0619M11 7.43811L13.5 4.50001L10.5 1.93811" stroke="currentColor" stroke-width="2"/>
                          </svg>
                      </button>
                    </div>
                      
                    <div id="draftsGrid" class="grid gap-6 grid-cols-3">

                        <div class="group relative flex flex-col bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden animate-pulse">
                          <div class="relative h-48 w-full bg-gray-200 dark:bg-slate-700 skeletonPlatform-loader"></div>
                          <div class="flex flex-1 flex-col justify-between p-5">
                            <div>
                              <div class="h-5 bg-gray-200 dark:bg-slate-700 rounded-md w-11/12 mb-3 skeletonPlatform-loader"></div>
                              <div class="h-5 bg-gray-200 dark:bg-slate-700 rounded-md w-4/6 skeletonPlatform-loader"></div>
                            </div>
                            <div class="flex items-center justify-between mt-4 pt-4 border-t border-slate-100 dark:border-slate-700">
                              <div class="h-4 bg-gray-200 dark:bg-slate-700 rounded w-20 skeletonPlatform-loader"></div>
                              <div class="flex items-center gap-1.5">
                                <div class="h-4 bg-gray-200 dark:bg-slate-700 rounded w-12 skeletonPlatform-loader"></div>
                                <div class="h-4 w-4 bg-gray-200 dark:bg-slate-700 rounded skeletonPlatform-loader"></div>
                              </div>
                            </div>
                          </div>
                        </div>


                        <div class="group relative flex flex-col bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden animate-pulse">
                          <div class="relative h-48 w-full bg-gray-200 dark:bg-slate-700 skeletonPlatform-loader"></div>
                          <div class="flex flex-1 flex-col justify-between p-5">
                            <div>
                              <div class="h-5 bg-gray-200 dark:bg-slate-700 rounded-md w-11/12 mb-3 skeletonPlatform-loader"></div>
                              <div class="h-5 bg-gray-200 dark:bg-slate-700 rounded-md w-4/6 skeletonPlatform-loader"></div>
                            </div>
                            <div class="flex items-center justify-between mt-4 pt-4 border-t border-slate-100 dark:border-slate-700">
                              <div class="h-4 bg-gray-200 dark:bg-slate-700 rounded w-20 skeletonPlatform-loader"></div>
                              <div class="flex items-center gap-1.5">
                                <div class="h-4 bg-gray-200 dark:bg-slate-700 rounded w-12 skeletonPlatform-loader"></div>
                                <div class="h-4 w-4 bg-gray-200 dark:bg-slate-700 rounded skeletonPlatform-loader"></div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="group relative flex flex-col bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden animate-pulse">
                          <div class="relative h-48 w-full bg-gray-200 dark:bg-slate-700 skeletonPlatform-loader"></div>
                          <div class="flex flex-1 flex-col justify-between p-5">
                            <div>
                              <div class="h-5 bg-gray-200 dark:bg-slate-700 rounded-md w-11/12 mb-3 skeletonPlatform-loader"></div>
                              <div class="h-5 bg-gray-200 dark:bg-slate-700 rounded-md w-4/6 skeletonPlatform-loader"></div>
                            </div>
                            <div class="flex items-center justify-between mt-4 pt-4 border-t border-slate-100 dark:border-slate-700">
                              <div class="h-4 bg-gray-200 dark:bg-slate-700 rounded w-20 skeletonPlatform-loader"></div>
                              <div class="flex items-center gap-1.5">
                                <div class="h-4 bg-gray-200 dark:bg-slate-700 rounded w-12 skeletonPlatform-loader"></div>
                                <div class="h-4 w-4 bg-gray-200 dark:bg-slate-700 rounded skeletonPlatform-loader"></div>
                              </div>
                            </div>
                          </div>
                        </div>
                    </div>

                    <div id="noDrafts" class="hidden flex flex-col items-center justify-center py-20 text-center border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl">
                      <div class="p-3 bg-slate-50 dark:bg-slate-800 rounded-full mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                        </svg>
                      </div>
                      <h3 class="text-sm font-semibold text-slate-900 dark:text-white">No drafts found</h3>
                      <p class="mt-1 text-sm text-gray-600">Get started by generating your first post above.</p>
                    </div>
                      
                    <div id="PaginBtns" class="flex justify-center mt-8 space-x-6 font-sans hidden">
                      <button id="prevDrafts" 
                              class="flex items-center px-6 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-xl shadow-md 
                                     hover:bg-gray-50 hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition duration-200 ease-in-out"
                              disabled>
                          <svg class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" clip-rule="evenodd" d="M11.7071 4.29289C12.0976 4.68342 12.0976 5.31658 11.7071 5.70711L6.41421 11H20C20.5523 11 21 11.4477 21 12C21 12.5523 20.5523 13 20 13H6.41421L11.7071 18.2929C12.0976 18.6834 12.0976 19.3166 11.7071 19.7071C11.3166 20.0976 10.6834 20.0976 10.2929 19.7071L3.29289 12.7071C3.10536 12.5196 3 12.2652 3 12C3 11.7348 3.10536 11.4804 3.29289 11.2929L10.2929 4.29289C10.6834 3.90237 11.3166 3.90237 11.7071 4.29289Z" fill="currentColor"/>
                          </svg>
                          Newer Drafts
                      </button>
                      
                      <button id="nextDrafts" 
                              class="flex items-center px-6 py-2 text-sm font-semibold text-white bg-gray-600 rounded-xl shadow-md 
                                     hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition duration-200 ease-in-out">
                          Older Drafts 
                          <svg class="w-5 h-5 ml-2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" clip-rule="evenodd" d="M12.2929 4.29289C12.6834 3.90237 13.3166 3.90237 13.7071 4.29289L20.7071 11.2929C21.0976 11.6834 21.0976 12.3166 20.7071 12.7071L13.7071 19.7071C13.3166 20.0976 12.6834 20.0976 12.2929 19.7071C11.9024 19.3166 11.9024 18.6834 12.2929 18.2929L17.5858 13H4C3.44772 13 3 12.5523 3 12C3 11.4477 3.44772 11 4 11H17.5858L12.2929 5.70711C11.9024 5.31658 11.9024 4.68342 12.2929 4.29289Z" fill="currentColor"/>
                          </svg>
                      </button>
                  </div>
                  </section>


                  <section>

                    <div class="min-h-full py-8 px-4 sm:px-6 lg:px-8">
                      <div class="mx-auto max-w-7xl">
                          
                          <div class="md:flex md:items-center md:justify-between mb-6">
                              <div class="min-w-0 flex-1">
                                  <h2 class="text-2xl font-semibold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight">
                                      Approved Drafts
                                  </h2>
                                  <p class="mt-1 text-sm text-gray-500">Overview of all content approved for publication.</p>
                              </div>
                              <div class="mt-4 flex md:ml-4 md:mt-0">
                                  <button type="button" onclick="fetchData()" class="ml-3 inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">
                                      <svg class="-ml-0.5 mr-1.5 h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" /></svg>
                                      Refresh
                                  </button>
                              </div>
                          </div>
              
                          <div class="bg-white rounded-lg overflow-hidden">
                              
                              <div class="relative">
                                  
                                <div id="skeletonDraft" class="space-y-6">
                                  <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                                    <div class="h-14 bg-gray-50 skeletonPlatform-loader"></div>
                                    <div class="p-6 space-y-4">
                                      <div class="h-5 w-48 bg-gray-200 rounded skeletonPlatform-loader"></div>
                                      <div class="h-4 w-64 bg-gray-200 rounded skeletonPlatform-loader"></div>
                                      <div class="flex items-center gap-8">
                                        <div class="h-8 w-32 bg-gray-200 rounded-full skeletonPlatform-loader"></div>
                                        <div class="h-4 w-24 bg-gray-200 rounded skeletonPlatform-loader"></div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                  <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 overflow-hidden" >
                                  <table class="w-full text-sm text-left ">
                                      <thead class="bg-gray-50 ">
                                          <tr>
                                              <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-xs font-[400] uppercase tracking-wide text-gray-500 sm:pl-6">Title & Preview</th>
                                              <th scope="col" class="px-3 py-3.5 text-left text-xs font-[400] uppercase tracking-wide text-gray-500">Created At</th>
                                              <th scope="col" class="px-3 py-3.5 text-left text-xs font-[400] uppercase tracking-wide text-gray-500">Status</th>
                                              <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-6">
                                                  <span class="sr-only">View</span>
                                              </th>
                                          </tr>
                                      </thead>
                                        <tbody id="tableBody" class="divide-y divide-gray-200 bg-white">
                                    
                                        </tbody>
                                  </table>
                                </div>
              
                                  <div id="errorState" class="hidden flex flex-col items-center justify-center py-12 text-center text-red-600">
                                      <div><svg class="h-10 w-10 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></div>
                                      <div><p class="text-sm font-medium">Failed to load data.</p></div>
                                  </div>
              
                                  <div id="emptyState" class="hidden flex-col items-center justify-center py-16 text-center">
                                      <div class="rounded-full bg-gray-50 p-4 mb-3">
                                          <svg class="h-8 w-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" /></svg>
                                      </div>
                                      <h3 class="mt-2 text-sm font-semibold text-gray-900">No approved drafts</h3>
                                      <p class="mt-1 text-sm text-gray-500">There are no tasks currently in this view.</p>
                                  </div>
                              </div>
              
                              <div class="flex items-center justify-between  bg-white px-4 py-3 sm:px-6">
                                  <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between">
                                      <div>
                                          <p class="text-sm text-gray-700">
                                              Showing <span class="font-medium" id="lblStart">0</span> to <span class="font-medium" id="lblEnd">0</span> of <span class="font-medium" id="lblTotal">0</span> results
                                          </p>
                                      </div>
                                      <div>
                                          <nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination">
                                              <button type="button" id="btnPrev" class="relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed">
                                                  <span class="sr-only">Previous</span>
                                                  <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                                      <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
                                                  </svg>
                                                  <span class="ml-1 text-sm font-medium">Prev</span>
                                              </button>
                                              <button type="button" id="btnNext" class="relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed">
                                                  <span class="mr-1 text-sm font-medium">Next</span>
                                                  <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                                      <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
                                                  </svg>
                                              </button>
                                          </nav>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              
                  </section>


                  <section id="Platform">

                    <div class="min-h-full">
                      <header class="bg-white shadow-sm border-b">
                        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                          <div class="flex justify-between items-center">
                            <div class="flex-1">
                              <h1 class="text-2xl lg:text-3xl font-semibold text-neutral-900 tracking-tight">Platforms</h1>
                              <p class="text-sm text-neutral-500 mt-2 max-w-md">Manage platforms</p>
                            </div>
                            <div class="flex gap-3">
                              <button id="refreshBtn" class="px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50">
                                Refresh
                              </button>
                              <button id="openModalBtn" class="flex items-center gap-1 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm font-medium">
                                <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                  <path d="M12 5L12 19"/>
                                  <path d="M5 12L19 12"/>
                                </svg>
                                  New Platform
                              </button>
                            </div>
                          </div>
                        </div>
                      </header>
                  
                      <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
                      <div id="skeletonPlatform" class="space-y-6">
                        <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                          <div class="h-14 bg-gray-50 skeletonPlatform-loader"></div>
                          <div class="p-6 space-y-4">
                            <div class="h-5 w-48 bg-gray-200 rounded skeletonPlatform-loader"></div>
                            <div class="h-4 w-64 bg-gray-200 rounded skeletonPlatform-loader"></div>
                            <div class="flex items-center gap-8">
                              <div class="h-8 w-32 bg-gray-200 rounded-full skeletonPlatform-loader"></div>
                              <div class="h-4 w-24 bg-gray-200 rounded skeletonPlatform-loader"></div>
                            </div>
                          </div>
                        </div>
                      </div>
                  
                      <div id="PlatformEmptyState" class="hidden flex-col items-center justify-center py-2 text-center">
                        <div class="rounded-full bg-gray-50 p-4 mb-3 inline-block">
                            <svg class="h-8 w-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" /></svg>
                        </div>
                        <h3 class="mt-2 text-sm font-semibold text-gray-900">No platforms yet</h3>
                        <p class="mt-1 text-sm text-gray-500">Add your first social platform to get started.</p>
                        <button id="openModalBtn2" class="mt-6 px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                          Create Platform
                        </button>
                    </div>

                      <div id="table" class="hidden bg-white shadow overflow-hidden sm:rounded-lg">
                        <table class="min-w-full divide-y divide-gray-200">
                          <thead class="bg-gray-50">
                            <tr>
                              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">API</th>
                              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Token</th>
                              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Created</th>
                              <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th>
                            </tr>
                          </thead>
                          <tbody id="tbody" class="bg-white divide-y divide-gray-200"></tbody>
                        </table>
                      </div>
                    </main>
                  </div>

                  <dialog id="createModal" class="p-8 rounded-2xl shadow-2xl max-w-lg w-full bg-white">
                    <h2 class="text-2xl font-bold mb-6">Add New Platform</h2>

                    <form id="createForm" class="space-y-5">
                      <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Platform Name *</label>
                        <input name="name" required placeholder="e.g. Facebook" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"/>
                      </div>
                      <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">API Name (optional)</label>
                        <input name="api_name" placeholder="e.g. facebook_graph" class="w-full px-4 py-2 border border-gray-300 rounded-lg"/>
                      </div>
                      <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Access Token *</label>
                        <textarea name="access_token" required placeholder="Paste your access token here" class="w-full px-4 py-2 border border-gray-300 rounded-lg font-mono text-sm"></textarea>
                      </div>
                      <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Refresh Token (optional)</label>
                        <textarea name="refresh_token" rows="2" placeholder="Optional" class="w-full px-4 py-2 border border-gray-300 rounded-lg font-mono text-sm"></textarea>
                      </div>
                
                      <div class="flex justify-end gap-3 mt-8">
                        <button type="button" id="cancelBtn" class="px-5 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                          Cancel
                        </button>
                        <button type="submit" id="saveBtn" class="px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                          Save Platform
                        </button>
                      </div>
                    </form>
                  </dialog>
                


                  </section>


                  <section>
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-12">
        
                      <!-- Dashboard Header -->
                      <div class="mb-8 flex flex-col lg:flex-row lg:items-end justify-between gap-6 slide-up">
                          <div class="flex-1">
                              <h1 class="text-2xl lg:text-3xl font-semibold text-neutral-900 tracking-tight">Task Operations</h1>
                              <p class="text-sm text-neutral-500 mt-2 max-w-md">Monitor scheduled automation, delivery status, and error logs with precision.</p>
                          </div>
                          <!-- Status Filter -->
                          <div class="w-full lg:w-44">
                              <label for="statusFilterShd" class="sr-only">Filter by Status</label>
                              <div class="relative">
                                  <select id="statusFilterShd" class="appearance-none block w-full pl-4 pr-10 py-3 text-sm border border-neutral-200 rounded-xl  bg-white focus:outline-none   transition-all duration-200 ease-in-out cursor-pointer hover:border-neutral-300">
                                      <option value="">All Statuses</option>
                                      <option value="scheduled">Scheduled</option>
                                      <option value="posted">Posted</option>
                                      <option value="failed">Failed</option>
                                      <option value="cancelled">Cancelled</option>
                                  </select>
                              </div>
                          </div>
                      </div>
              
                      <!-- Main Card -->
                      <div class="bg-white rounded-2xl border border-neutral-200 overflow-hidden fade-in">
                          
                          <!-- Table Container -->
                          <div class="overflow-x-auto custom-scrollbar">
                              <table id="tasksTableShd" class="min-w-full divide-y divide-neutral-100 hidden">
                                  <thead class="bg-neutral-50">
                                      <tr>
                                          <th scope="col" class="px-6 py-5 text-left text-xs font-semibold text-neutral-500 uppercase tracking-wider">Task Title</th>
                                          <th scope="col" class="px-6 py-5 text-left text-xs font-semibold text-neutral-500 uppercase tracking-wider">Status</th>
                                          <th scope="col" class="px-6 py-5 text-left text-xs font-semibold text-neutral-500 uppercase tracking-wider">Created</th>
                                          <th scope="col" class="px-6 py-5 text-left text-xs font-semibold text-neutral-500 uppercase tracking-wider">Scheduled For</th>
                                          <th scope="col" class="px-6 py-5 text-right text-xs font-semibold text-neutral-500 uppercase tracking-wider">Actions</th>
                                      </tr>
                                  </thead>
                                  <tbody id="tasksTableBodyShd" class="bg-white divide-y divide-neutral-100">
                                      
                                  </tbody>
                              </table>
                          </div>
              
                          <!-- Loading State -->
                          <div id="tableLoadingShd" class="hidden flex flex-col justify-center items-center py-20 fade-in">
                              <svg class="animate-spin -ml-1 mr-3 h-8 w-8 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3"></circle>
                                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                          </div>
              
                          <!-- Empty State -->
                          <div id="noTasksShd" class="hidden flex flex-col justify-center items-center py-5 text-center fade-in">
                              <div class="bg-neutral-100 rounded-full p-4 mb-4 inline-flex items-center justify-center">
                                  <svg class="w-8 h-8 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                              </div>
                              <h3 class="text-lg font-semibold text-neutral-900 mb-1">No tasks found</h3>
                              <p class="text-sm text-neutral-500">Adjust filters or create a new task to see results.</p>
                          </div>
              
                          <!-- Pagination Footer -->
                          <div class="bg-neutral-50 px-6 py-5 border-t border-neutral-100 flex items-center justify-between">
                              <span id="pageInfoShd" class="text-sm text-neutral-600 font-medium">Loading...</span>
                              <div class="flex gap-2">
                                  <button id="prevPageShd" class="inline-flex items-center gap-2 px-4 py-2 border border-neutral-300 text-sm font-medium rounded-xl text-neutral-700 bg-white hover:bg-neutral-50 focus:outline-none  disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200  hover:shadow-medium" disabled>
                                      <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                                      Previous
                                  </button>
                                  <button id="nextPageShd" class="inline-flex items-center gap-2 px-4 py-2 border border-neutral-300 text-sm font-medium rounded-xl text-neutral-700 bg-white hover:bg-neutral-50 focus:outline-none  disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200  hover:shadow-medium" disabled>
                                      Next
                                      <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                                  </button>
                              </div>
                          </div>
                      </div>
                  </div>
              
                  </section>




                  <section>

                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                      <div class="flex-1 mb-5">
                        <h1 class="text-2xl lg:text-3xl font-semibold text-neutral-900 tracking-tight">Error logs</h1>
                        <p class="text-sm text-neutral-500 mt-2 max-w-md">Manage and monitor system error logs</p>
                      </div>

                      <div class="flex justify-between items-center mb-6">
                        <button id="toggleFiltersBtnErr" class="inline-flex items-center gap-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-all duration-200 focus:outline-none  ">
                          Filters
                          <i id="filterIcon" class="fas fa-chevron-down text-gray-400"></i>
                        </button>
                        <button id="refreshBtnErr" class="inline-flex items-center gap-2 p-3 border border-gray-300 rounded-full text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 hover:border-gray-700 transition-all duration-200 shadow-sm focus:outline-none ">
                          <svg fill="currentColor" width="12" height="12" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15.544 28.080c-0.002-0.006-0.008-0.010-0.012-0.015l-2.873-4.489c-0.204-0.335-0.646-0.454-0.992-0.266l-0.256 0.157c-0.344 0.188-0.337 0.673-0.133 1.008l1.841 2.857c-0.157-0.035-0.316-0.063-0.471-0.103-3.224-0.843-5.953-3.026-7.485-5.988-1.448-2.797-1.72-5.99-0.766-8.992s3.118-5.452 5.915-6.899c0.476-0.247 0.662-0.832 0.416-1.308-0.246-0.477-0.832-0.663-1.308-0.416-3.258 1.686-5.763 4.54-6.874 8.036s-0.794 7.215 0.892 10.473c1.786 3.448 4.963 5.989 8.72 6.973 0.043 0.011 0.087 0.017 0.13 0.028l-2.541 1.288c-0.344 0.189-0.458 0.613-0.254 0.948l0.098 0.256c0.205 0.335 0.557 0.454 0.9 0.266l4.651-2.381c0.006-0.004 0.012-0.003 0.018-0.007l0.312-0.171c0.172-0.095 0.287-0.249 0.332-0.422 0.047-0.172 0.025-0.364-0.076-0.531zM28.559 10.025c-1.783-3.447-4.862-5.988-8.618-6.972-0.267-0.070-0.541-0.124-0.814-0.179l2.494-1.265c0.344-0.189 0.549-0.614 0.345-0.949l-0.099-0.255c-0.205-0.336-0.648-0.454-0.991-0.267l-4.651 2.381c-0.006 0.003-0.012 0.002-0.018 0.006l-0.312 0.171c-0.173 0.095-0.287 0.249-0.332 0.422-0.047 0.172-0.025 0.364 0.077 0.53l0.185 0.304c0.003 0.006 0.008 0.010 0.012 0.016l2.873 4.489c0.203 0.335 0.646 0.454 0.991 0.266l0.226-0.157c0.344-0.188 0.366-0.673 0.163-1.008l-1.85-2.87c0.407 0.063 0.811 0.138 1.207 0.242 3.226 0.845 5.856 3.027 7.387 5.986 1.448 2.797 1.72 5.99 0.765 8.991s-3.020 5.451-5.818 6.901c-0.476 0.247-0.662 0.831-0.415 1.308 0.172 0.332 0.511 0.524 0.863 0.524 0.15 0 0.302-0.035 0.446-0.109 3.259-1.686 5.664-4.54 6.776-8.035 1.111-3.497 0.794-7.217-0.893-10.473z"></path>
                        </svg>
                        </button>
                      </div>
                  
                      <!-- Filters Bar (Hidden by Default) -->
                      <div id="filtersBar" class="rounded-2xl shadow-sm border border-gray-200 p-5 mb-6 hidden transition-all duration-300 ease-in-out">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                          <div class="md:col-span-2">
                            <label for="searchInputErr" class="block text-sm font-medium text-gray-700 mb-1.5">Search logs</label>
                            <div class="relative">
                              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-search text-gray-400 text-sm"></i>
                              </div>
                              <input 
                                type="text" 
                                id="searchInputErr"
                                placeholder="Search by task ID, platform, error type, message..."
                                class="block w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-700 focus:border-gray-700 text-sm transition-all duration-200 shadow-sm"
                              />
                            </div>
                          </div>
                  
                          <div>
                            <label for="fromDateErr" class="block text-sm font-medium text-gray-700 mb-1.5">From Date</label>
                            <input 
                              type="datetime-local" 
                              id="fromDateErr"
                              class="block w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-700 focus:border-gray-700 text-sm transition-all duration-200 shadow-sm"
                            />
                          </div>
                  
                          <div>
                            <label for="toDateErr" class="block text-sm font-medium text-gray-700 mb-1.5">To Date</label>
                            <input 
                              type="datetime-local" 
                              id="toDateErr"
                              class="block w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-700 focus:border-gray-700 text-sm transition-all duration-200 shadow-sm"
                            />
                          </div>
                        </div>
                  
                        <div class="mt-5 flex justify-end gap-3">
                          <button id="clearFiltersBtnErr" class="px-5 py-2.5 text-sm font-medium text-gray-700 hover:text-gray-900 transition-all duration-200 focus:outline-none ">
                            Clear filters
                          </button>
                        </div>
                      </div>
                  
                      <!-- Table Card -->
                      <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                        <div class="overflow-x-auto">
                          <table id="errorLogsTableErr" class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                              <tr>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Error ID</th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Task ID</th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Platform</th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Type</th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Code</th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Message</th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Date</th>
                              </tr>
                            </thead>
                            <tbody id="errorLogsTbodyErr" class="bg-white divide-y divide-gray-200">
                              <!-- Dynamic rows will be injected here -->
                            </tbody>
                          </table>
                        </div>
                  
                        <!-- Pagination & Info -->
                        <div class="bg-gray-50 px-6 py-3 border-t border-gray-200">
                          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                            <div class="text-sm text-gray-700 opacity-0">
                              Showing <span class="font-medium" id="pageInfoErr">1</span> to <span class="font-medium" id="limitInfoErr">20</span> of 
                              <span class="font-medium" id="totalCountErr">127</span> results
                            </div>
                            <div class="mt-4 sm:mt-0 flex justify-center">
                              <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
                                <button id="prevPageBtnErr" class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 hover:border-gray-700 rounded-l-md disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-all duration-200 focus:outline-none ">
                                  Previous
                                </button>
                                <button id="nextPageBtnErr" class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 hover:border-gray-700 rounded-r-md disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-all duration-200 focus:outline-none ">
                                  Next
                                </button>
                              </nav>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                  </section>

                </main>
            </div>
            <div class="tab-content">
              <div class="placeholder-screen">on the way !</div>
          </div>

            <div class="tab-content">
                <div class="placeholder-screen">?</div>
            </div>

            <div class="tab-content">
                <div class="placeholder-screen">?</div>
            </div>

            <div class="tab-content">
                <div class="placeholder-screen">?</div>
            </div>

        </div>
    </div>
</div>


  


  <div id="postUiModalOverlay" class="fixed inset-0 z-50 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="fixed inset-0 bg-slate-900/60 transition-opacity" onclick="closePostUiModal()"></div>
    <div class="fixed inset-0 z-10 overflow-y-auto">
      <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
        <div class="relative transform overflow-hidden rounded-2xl bg-white dark:bg-slate-850 text-left shadow-2xl transition-all sm:my-8 w-full max-w-5xl"
             onclick="event.stopPropagation()">
           <div id="modalContent"></div>
        </div>
      </div>
    </div>
  </div>

<!-- Updated Modal HTML: Added scheduling form elements -->
<div id="modalOverlay" class="relative z-50 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <!-- Backdrop -->
  <div class="fixed inset-0 bg-gray-900/80 transition-opacity"></div>

  <!-- Scrollable Container -->
  <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
    <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-6">
      
      <!-- Modal Panel -->
      <div class="relative transform overflow-hidden rounded-3xl bg-white text-left  transition-all sm:w-full sm:max-w-5xl border border-gray-200 flex flex-col">
        
        <!-- Main Grid Container -->
        <div class="flex flex-col lg:grid lg:grid-cols-12 h-full">
            
            <!-- LEFT COLUMN: Content Preview (Visuals & Text) -->
            <div class="lg:col-span-5 bg-gray-50/50 border-b lg:border-b-0 lg:border-r border-gray-200 p-6 lg:p-8 flex flex-col gap-6">
                
                <!-- Image Section -->
                <div class="group relative w-full overflow-hidden rounded-2xl bg-gray-200 border border-gray-300 shadow-sm aspect-video lg:aspect-square flex items-center justify-center">
                    <img id="modalImg" src="" class="w-full h-full object-cover transition-transform duration-700 hover:scale-105" style="display:none">
                    <div id="modalNoImg" class="flex flex-col items-center justify-center text-gray-400 hidden p-6 text-center">
                        <svg class="w-12 h-12 mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                        <span class="text-xs font-medium uppercase tracking-wide">No Media Preview</span>
                    </div>
                </div>

                <!-- Text Content Wrapper -->
                <div class="flex-1 min-h-0 flex flex-col">
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2">Caption Preview</label>
                    <div class="bg-white rounded-lg p-4 border border-gray-200 shadow-sm flex-1 overflow-y-auto max-h-48 lg:max-h-[none]">
                        <pre id="modalContentText" class="whitespace-pre-wrap text-sm leading-relaxed text-gray-600 font-sans"></pre>
                        <div class="mt-4 pt-3 border-t border-gray-100 flex flex-wrap gap-2">
                            <span id="modalHashtags" class="text-sm font-medium text-gray-500 italic"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RIGHT COLUMN: Details & Scheduling Controls -->
            <div class="lg:col-span-7 bg-white p-6 lg:p-8 flex flex-col h-full">
                
                <!-- Header -->
                <div class="flex justify-between items-start mb-6">
                    <div>
                        <h3 class="text-xl font-bold text-gray-900 tracking-tight" id="modalTitle">Task Details</h3>
                        
                    </div>
                    <span class="px-3 py-1 rounded-full bg-gray-100 text-gray-600 text-xs font-bold uppercase tracking-wide border border-gray-200">
                        Draft
                    </span>
                </div>

                <!-- Scrolling Area for Form Inputs -->
                <div class="flex-1 overflow-y-auto pr-2 custom-scrollbar">
                    
                    <!-- Scheduling Section -->
                    <div id="schedulingSection" class="hidden animate-in fade-in slide-in-from-bottom-2 duration-300">
                        <div class="mb-5 pb-4 border-b border-gray-100">
                            <h4 class="text-sm font-semibold text-gray-900 flex items-center gap-2">
                                <svg class="w-4 h-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                                Configuration
                            </h4>
                        </div>

                        <div class="space-y-6">
                            <div class="px-4">
                                <label class="block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Select Platforms</label>
                                <div id="platformsList" class="grid grid-cols-1 sm:grid-cols-2 gap-3"></div>
                                <div class="text-sm text-yellow-500 mt-2"> Instagram posting requires an image. Text-only posts are not supported. </div>
                            </div>

                            <div class="grid grid-cols-1 gap-5">
                                <div>
                                    <div class="flex items-center gap-2 mt-1 text-xs text-gray-500">
                                      <label class="block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Publish Date & Time (IST)</label>
                                      <svg class="w-4 h-4 mb-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                                      <span class="mb-2">AI Suggestion: <span id="modalTime" class="font-medium text-gray-700"></span></span>
                                    </div>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <svg class="h-4 w-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                        </div>
                                        <input type="datetime-local" id="scheduledAtInput" class="block w-full rounded-lg border-gray-300 bg-white pl-10 px-4 py-2.5 text-gray-900 shadow-sm focus:border-gray-500 focus:ring-gray-500 sm:text-sm transition-colors ">
                                    </div>
                                </div>
                            </div>

                            <!-- Notes -->
                            <div>
                                <label class="block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Internal Notes</label>
                                <textarea id="notesInput" rows="3" class="block w-full rounded-lg border-gray-300 bg-white px-4 py-2 text-gray-900 shadow-sm focus:border-gray-500 focus:ring-gray-500 sm:text-sm resize-none transition-colors  " placeholder="Add specific instructions for the reviewer..."></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Empty State Placeholder (Visible if Scheduling hidden) -->
                    <div id="emptyStatePlaceholder" class="hidden h-32 flex items-center justify-center border-2 border-dashed border-gray-100 rounded-lg">
                        <span class="text-sm text-gray-400">Scheduling options not available</span>
                    </div>

                </div>

                <!-- Footer Actions -->
                <div class="mt-8 pt-4 border-t border-gray-100 flex flex-col-reverse sm:flex-row sm:justify-end gap-3">
                     <button type="button" id="closeModalBtn" class="inline-flex w-full justify-center rounded-xl bg-white px-5 py-2.5 text-sm font-semibold text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:w-auto transition-all">
                        Cancel
                    </button>
                    <button type="button" id="scheduleBtn" class="hidden w-full inline-flex justify-center items-center rounded-xl bg-gray-600 px-6 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-gray-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600 transition-all">
                        Confirm Schedule
                    </button>
                </div>
            </div>
        </div>
      </div>
    </div>
  </div>
</div>



<div id="taskDetailsModalShd" class="fixed inset-0 z-50 hidden transition-opacity duration-300" aria-labelledby="modalShd-title" role="dialog" aria-modal="true">
  <div class="fixed inset-0 bg-slate-900/40 transition-opacity"></div>

  <div class="fixed inset-0 z-10 overflow-y-auto">
      <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-6">

          <div class="relative transform overflow-hidden rounded-2xl bg-white text-left shadow-2xl ring-1 ring-black/5 transition-all w-full max-w-7xl h-[85vh] flex flex-col">
              <div class="bg-white px-6 py-4 border-b border-slate-100 flex justify-between items-center flex-shrink-0 z-20">
                  <div class="flex items-center gap-4">
                      <div class="h-10 w-10 rounded-full bg-slate-50 flex items-center justify-center border border-slate-100">
                          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>
                      </div>
                      <div>
                          <h3 class="text-lg font-semibold text-slate-800 flex items-center gap-3">
                              Task Details
                              <span id="detailStatusHeaderShd" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border shadow-sm"></span>
                          </h3>
                          <p class="text-xs text-slate-400 font-mono mt-0.5 flex items-center gap-1">
                              ID: <span id="detailIdDisplayShd" class="select-all hover:text-slate-600 transition-colors cursor-pointer">Loading...</span>
                          </p>
                      </div>
                  </div>

                  <button id="closeModalShd" type="button" class="rounded-full bg-slate-50 p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 focus:outline-none  transition-all duration-200">
                      <span class="sr-only">Close</span>
                      <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                      </svg>
                  </button>
              </div>

              <!-- Loading State -->
              <div id="modalLoadingShd" class="hidden flex flex-col justify-center items-center h-full bg-slate-50/50">
                  <div class="animate-spin rounded-full h-10 w-10 border-2 border-slate-200 border-b-slate-600 mb-3"></div>
                  <span class="text-sm text-gray-600 font-medium">Retrieving data...</span>
              </div>

              <!-- Content Area: Split View Layout -->
              <div id="modalContentShd" class="hidden flex-1 overflow-y-auto bg-slate-50/50 custom-scrollbar p-3">
                  
                  <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-full">
                      
                      <!-- LEFT COLUMN: Overview & Metadata (Total 4/12 cols) -->
                      <div class="lg:col-span-4 space-y-6">
                          
                          <!-- Main Info Card -->
                          <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-5">
                              <div class="flex justify-between items-start mb-4">
                                  <h4 class="text-xs font-semibold text-slate-400 uppercase tracking-wider">Overview</h4>
                                  <span id="detailCreatedAtShd" class="text-xs text-slate-400 bg-slate-50 px-2 py-1 rounded border border-slate-100"></span>
                              </div>

                              <div class="space-y-5">
                                  <!-- Title -->
                                  <div>
                                      <label class="text-[11px] font-semibold text-slate-400 uppercase tracking-wide mb-1 block">Task Title</label>
                                      <p id="detailTitleShd" class="text-md text-slate-700 leading-snug"></p>
                                  </div>

                                  <div class="h-px bg-slate-100 w-full"></div>

                                  <!-- Scheduled Info -->
                                  <div>
                                      <label class="text-[11px] font-semibold text-slate-400 uppercase tracking-wide mb-1 block">Scheduled Execution</label>
                                      <div class="flex items-center text-sm font-medium text-slate-700 bg-slate-50 p-2.5 rounded-lg border border-slate-100">
                                          <svg class="flex-shrink-0 mr-2.5 h-4 w-4 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                          </svg>
                                          <span id="detailScheduledAtShd"></span>
                                      </div>
                                  </div>

                                  <!-- Metadata Grid -->
                                  <div class="grid grid-cols-1 gap-4">
                                      <div>
                                          <label class="text-[11px] font-semibold text-slate-400 uppercase tracking-wide mb-1 block">Last Updated</label>
                                          <p id="detailUpdatedAtShd" class="text-sm text-slate-600 font-mono"></p>
                                      </div>
                                      <div id="detailTimeZoneShd">
                                          <label class="text-[11px] font-semibold text-slate-400 uppercase tracking-wide mb-1 block">Time Zone</label>
                                          <p id="detailTimeZoneValueShd" class="text-sm text-slate-600 font-mono bg-slate-100 inline-block px-2 py-0.5 rounded"></p>
                                      </div>
                                  </div>
                              </div>
                          </div>

                          <!-- Context/Notes Card -->
                          <div class="bg-white rounded-xl border border-slate-200 shadow-sm flex-1 flex flex-col">
                              <div class="p-4 border-b border-slate-100 bg-slate-50/50 rounded-t-xl">
                                  <h4 class="text-xs font-semibold text-gray-600 uppercase tracking-wider flex items-center gap-2">
                                      <svg class="w-4 h-4 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                      </svg>
                                      Context / Payload
                                  </h4>
                              </div>
                              <div class="p-4">
                                  <div id="detailNotesShd" class="text-sm text-slate-600 leading-relaxed font-mono bg-slate-50 p-3 rounded-lg border border-slate-100 overflow-x-auto max-h-[200px] custom-scrollbar"></div>
                              </div>
                          </div>

                      </div>

                      <!-- RIGHT COLUMN: History & Logs (Total 8/12 cols) -->
                      <div class="lg:col-span-8 flex flex-col gap-6">
                          
                          <!-- Attempts Section -->
                          <div class="bg-white rounded-xl border border-slate-200 shadow-sm flex flex-col h-auto overflow-hidden">
                              <div class="px-5 py-4 border-b border-slate-100 flex items-center justify-between bg-slate-50/30">
                                  <h4 class="text-sm font-semibold text-slate-800 flex items-center gap-2">
                                      <div class="p-1.5 bg-blue-50 rounded-md">
                                          <svg class="h-4 w-4 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                          </svg>
                                      </div>
                                      Execution Attempts
                                  </h4>
                                  <span class="text-[10px] font-medium px-2 py-1 bg-slate-100 text-gray-600 rounded">Log</span>
                              </div>
                              
                              <div class="overflow-y-auto custom-scrollbar flex-1 bg-white">
                                  <table class="min-w-full divide-y divide-slate-100">
                                      <thead class="bg-slate-50 sticky top-0 z-10">
                                          <tr>
                                              <th class="px-5 py-3 text-left text-[11px] font-semibold text-slate-400 uppercase tracking-wider">Platform</th>
                                              <th class="px-5 py-3 text-left text-[11px] font-semibold text-slate-400 uppercase tracking-wider">Status</th>
                                              <th class="px-5 py-3 text-left text-[11px] font-semibold text-slate-400 uppercase tracking-wider">Timestamp</th>
                                          </tr>
                                      </thead>
                                      <tbody id="attemptsTableBodyShd" class="bg-white divide-y divide-slate-50 text-sm"></tbody>
                                  </table>
                                  <!-- Empty State -->
                                  <div id="noAttemptsShd" class="hidden flex flex-col items-center justify-center py-12 text-slate-400">
                                      <svg class="h-10 w-10 mb-2 opacity-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                      </svg>
                                      <p class="text-xs">No attempts recorded yet</p>
                                  </div>
                              </div>
                          </div>

                          <!-- Errors Section -->
                          <div class="bg-white rounded-xl border border-slate-200 shadow-sm flex flex-col h-auto overflow-hidden">
                              <div class="px-5 py-4 border-b border-slate-100 flex items-center justify-between bg-slate-50/30">
                                  <h4 class="text-sm font-semibold text-slate-800 flex items-center gap-2">
                                      <div class="p-1.5 bg-red-50 rounded-md">
                                          <svg class="h-4 w-4 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                          </svg>
                                      </div>
                                      System Logs & Errors
                                  </h4>
                              </div>

                              <div class="overflow-y-auto custom-scrollbar flex-1 bg-white">
                                  <table class="min-w-full divide-y divide-slate-100">
                                      <tbody id="errorsTableBodyShd" class="bg-white divide-y divide-slate-50 text-sm font-mono text-red-600"></tbody>
                                  </table>
                                  
                                  <!-- Empty State: Healthy -->
                                  <div id="noErrorsShd" class="hidden flex flex-col items-center justify-center py-6 bg-white h-full">
                                      <div class="rounded-full bg-emerald-100 p-3 mb-3">
                                          <svg class="h-6 w-6 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                          </svg>
                                      </div>
                                      <span class="text-sm font-medium text-emerald-800">All systems operational</span>
                                      <span class="text-xs text-emerald-600 mt-1">No errors logs found</span>
                                  </div>
                              </div>
                          </div>

                      </div>
                  </div>
              </div>

              <!-- Footer -->
              <div class="bg-white px-6 py-4 border-t border-slate-100 flex justify-end flex-shrink-0 z-20">
                  <button type="button" id="closeModalBtnFooterShd" class="inline-flex justify-center rounded-lg border border-slate-200 bg-white px-6 py-2.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 hover:text-slate-900 focus:outline-none  transition-all duration-200">
                      Close Details
                  </button>
              </div>

          </div>
      </div>
  </div>
</div>


<div id="postUiModalOverlayGfr" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
  <div class="bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-7xl max-h-[95vh] overflow-hidden flex flex-col">

      <div class="flex items-center justify-between px-6 py-4 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-850">
          <div class="text-left">
              <h2 class="text-lg font-bold text-slate-900 dark:text-white">Edit Draft</h2>
              <p id="modalTaskIdGfr" class="text-xs text-gray-600 font-mono"></p>
          </div>
          <div class="flex gap-3">
              <button id="btnApproveGfr" class="flex items-center justify-center bg-white border border-gray-200 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-3xl text-sm font-semibold transition-all">
                  Approve Draft
              </button>
              <button onclick="closePostUiModalGfr()" class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 p-2 rounded-lg transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
              </button>
          </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-12 gap-0 flex-1 overflow-hidden">
          <div class="lg:col-span-8 p-6 sm:p-7 space-y-6 overflow-y-auto no-scrollbar border-r border-slate-200 dark:border-slate-700">
              <div class="space-y-1 text-left relative">
                  <label id="postCaption" class="block text-lg font-semibold text-gray-600 ml-2 mb-1 tracking-wider">Post Caption</label>
                  <textarea id="captionGfr" rows="13" class="w-full p-4 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-3xl text-md  focus:border-slate-200 transition shadow-sm outline-none ring-0 focus:ring-0 focus-visible:ring-0 focus:outline-none"></textarea>
                 <div  class="absolute bottom-4 right-4 flex flex-col items-end gap-3 z-50">

                    <div id="tools-menu" 
                         class="flex flex-col items-center gap-2 p-1.5 bg-white rounded-full shadow-lg  border border-gray-100
                                transition-all duration-300 ease-spring origin-bottom 
                                opacity-0 scale-y-50 translate-y-10 pointer-events-none absolute bottom-20 right-0">
                        
                        <button title="Make the caption concise" name="concise" class="p-3 text-gray-500 hover:text-gray-800 hover:bg-gray-100 rounded-full transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path d="m17.5 10.5l2 2M14 14l2 2m-5.5 1.5l2 2"/><path stroke-linejoin="round" d="M10.536 4.678c1.364-1.365 2.047-2.047 2.808-2.363a4.14 4.14 0 0 1 3.17 0c.761.316 1.444.998 2.808 2.363c1.365 1.364 2.047 2.047 2.363 2.808a4.14 4.14 0 0 1 0 3.17c-.316.761-.998 1.444-2.363 2.808l-5.857 5.858c-1.365 1.365-2.048 2.047-2.809 2.363a4.14 4.14 0 0 1-3.17 0c-.761-.316-1.444-.998-2.808-2.363c-1.365-1.364-2.047-2.047-2.363-2.808a4.14 4.14 0 0 1 0-3.17c.316-.761.998-1.444 2.363-2.808z"/></g></svg>
                        </button>
                        
                        <button title="Make the caption professional" name="professional" class="p-3 text-gray-500 hover:text-gray-800 hover:bg-gray-100 rounded-full transition-colors">
                            <svg width="18px" height="18px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3 11C3 9.11438 3 8.17157 3.58579 7.58579C4.17157 7 5.11438 7 7 7H8H16H17C18.8856 7 19.8284 7 20.4142 7.58579C21 8.17157 21 9.11438 21 11V17C21 18.8856 21 19.8284 20.4142 20.4142C19.8284 21 18.8856 21 17 21H16H8H7C5.11438 21 4.17157 21 3.58579 20.4142C3 19.8284 3 18.8856 3 17V11Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                                <path d="M8 21V5C8 3.89543 8.89543 3 10 3H14C15.1046 3 16 3.89543 16 5V21" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                                </svg>
                        </button>
            
                        <button title="Make the caption formal" name="formal" class="p-3 text-gray-500 hover:text-gray-800 hover:bg-gray-100 rounded-full transition-colors">
                            <svg width="18px" height="18px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M4 19V6.2C4 5.0799 4 4.51984 4.21799 4.09202C4.40973 3.71569 4.71569 3.40973 5.09202 3.21799C5.51984 3 6.0799 3 7.2 3H16.8C17.9201 3 18.4802 3 18.908 3.21799C19.2843 3.40973 19.5903 3.71569 19.782 4.09202C20 4.51984 20 5.0799 20 6.2V17H6C4.89543 17 4 17.8954 4 19ZM4 19C4 20.1046 4.89543 21 6 21H20M9 7H15M9 11H15M19 17V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                        </button>
                        
                        <button title="Custom Formating" onclick="activateInputMode()" class="p-3 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors">
                        <svg fill="currentColor" width="18px" height="18px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17.764,2A4.2,4.2,0,0,0,14.77,3.241L3.155,14.855a1,1,0,0,0-.28.55l-.863,5.438a1,1,0,0,0,1.145,1.145L8.6,21.125a1,1,0,0,0,.55-.28L20.759,9.23a4.236,4.236,0,0,0-3-7.23ZM7.96,19.2,4.2,19.8l.6-3.757,8.39-8.391,3.162,3.162ZM19.345,7.816,17.765,9.4,14.6,6.235l1.581-1.58a2.289,2.289,0,0,1,3.161,0,2.234,2.234,0,0,1,0,3.161Z"/></svg>
                        </button>
                    </div>
            
                    <div class="flex items-center gap-2 relative">
                        
                        <div id="input-container" class="w-0 opacity-0 overflow-hidden transition-all duration-500 ease-spring origin-right bg-white rounded-full shadow-md border border-gray-100 flex items-center h-14">
                        <input  type="text"  id="chat-input" placeholder="Ask anything..." class="w-full h-full px-6 py-3 bg-transparent text-gray-700 min-w-[280px] outline-none ring-0 focus:ring-0 focus-visible:ring-0 focus:outline-none border-none"></div>
                        <button title="Use AI to format the Caption" id="main-btn" onclick="handleMainClick()" class="group relative w-14 h-14 bg-white hover:bg-gray-50 text-gray-800 rounded-full shadow-md border border-gray-100 z-10 flex items-center justify-center overflow-hidden transition-transform active:scale-95">     
                        
                        <div class="absolute inset-0 flex items-center justify-center transition-all duration-300 ease-spring rotate-0 scale-100 opacity-100 group-[.input-mode]:-rotate-90 group-[.input-mode]:scale-0 group-[.input-mode]:opacity-0 group-[.menu-open]:rotate-45">
                          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M12.9914 2.86904C12.9914 2.86899 12.9914 2.86895 12.9914 2.86891C12.9256 2.37165 12.5016 2 12 2C11.4983 2 11.0743 2.37171 11.0086 2.86904L11.0086 2.86932L11.0085 2.86992L11.0075 2.87704L11.0029 2.91013C10.9985 2.94035 10.9917 2.98656 10.9822 3.04699C10.9633 3.16792 10.9339 3.34537 10.8927 3.56523C10.81 4.00611 10.6812 4.61161 10.4967 5.27082C10.1127 6.64363 9.5417 8.04408 8.79289 8.79289C8.04408 9.5417 6.64363 10.1127 5.27082 10.4967C4.61161 10.6812 4.00611 10.81 3.56523 10.8927C3.34537 10.9339 3.16792 10.9633 3.04699 10.9822C2.98656 10.9917 2.94035 10.9985 2.91013 11.0029L2.87704 11.0075L2.86992 11.0085L2.86932 11.0086C2.86923 11.0086 2.86913 11.0086 2.86904 11.0086C2.86899 11.0086 2.86895 11.0086 2.86891 11.0086C2.37165 11.0744 2 11.4984 2 12C2 12.5017 2.37171 12.9257 2.86904 12.9914L2.86932 12.9914L2.86992 12.9915L2.87704 12.9925L2.91013 12.9971C2.94035 13.0015 2.98656 13.0083 3.04699 13.0178C3.16792 13.0367 3.34537 13.0661 3.56523 13.1073C4.00611 13.19 4.61161 13.3188 5.27082 13.5033C6.64363 13.8873 8.04408 14.4583 8.79289 15.2071C9.5417 15.9559 10.1127 17.3564 10.4967 18.7292C10.6812 19.3884 10.81 19.9939 10.8927 20.4348C10.9339 20.6546 10.9633 20.8321 10.9822 20.953C10.9917 21.0134 10.9985 21.0596 11.0029 21.0899L11.0075 21.123L11.0085 21.1301L11.0086 21.1307C11.0086 21.1308 11.0086 21.1309 11.0086 21.131C11.0086 21.131 11.0086 21.131 11.0086 21.131C11.0743 21.6283 11.4983 22 12 22C12.5017 22 12.9257 21.6283 12.9914 21.131L12.9914 21.1307L12.9915 21.1301L12.9925 21.123L12.9971 21.0899C13.0015 21.0596 13.0083 21.0134 13.0178 20.953C13.0367 20.8321 13.0661 20.6546 13.1073 20.4348C13.19 19.9939 13.3188 19.3884 13.5033 18.7292C13.8873 17.3564 14.4583 15.9559 15.2071 15.2071C15.9559 14.4583 17.3564 13.8873 18.7292 13.5033C19.3884 13.3188 19.9939 13.19 20.4348 13.1073C20.6546 13.0661 20.8321 13.0367 20.953 13.0178C21.0134 13.0083 21.0596 13.0015 21.0899 12.9971L21.123 12.9925L21.1301 12.9915L21.1307 12.9914C21.1308 12.9914 21.1309 12.9914 21.131 12.9914C21.131 12.9914 21.131 12.9914 21.131 12.9914C21.6283 12.9257 22 12.5017 22 12C22 11.4983 21.6283 11.0743 21.131 11.0086L21.1307 11.0086L21.1301 11.0085L21.123 11.0075L21.0899 11.0029C21.0596 10.9985 21.0134 10.9917 20.953 10.9822C20.8321 10.9633 20.6546 10.9339 20.4348 10.8927C19.9939 10.81 19.3884 10.6812 18.7292 10.4967C17.3564 10.1127 15.9559 9.5417 15.2071 8.79289C14.4583 8.04408 13.8873 6.64363 13.5033 5.27082C13.3188 4.61161 13.19 4.00611 13.1073 3.56523C13.0661 3.34537 13.0367 3.16792 13.0178 3.04699C13.0083 2.98656 13.0015 2.94035 12.9971 2.91013L12.9925 2.87704L12.9915 2.86992L12.9914 2.86932C12.9914 2.86923 12.9914 2.86913 12.9914 2.86904ZM16.8722 12C15.7644 11.5928 14.6021 11.0163 13.7929 10.2071C12.9837 9.39792 12.4072 8.23564 12 7.12776C11.5928 8.23564 11.0163 9.39792 10.2071 10.2071C9.39792 11.0163 8.23564 11.5928 7.12776 12C8.23564 12.4072 9.39792 12.9837 10.2071 13.7929C11.0163 14.6021 11.5928 15.7644 12 16.8722C12.4072 15.7644 12.9837 14.6021 13.7929 13.7929C14.6021 12.9837 15.7644 12.4072 16.8722 12Z" fill="currentColor"/>
                            </svg>
                        </div>
                            <div class="absolute inset-0 flex items-center justify-center transition-all duration-300 ease-spring rotate-90 scale-0 opacity-0 group-[.input-mode]:rotate-0 group-[.input-mode]:scale-100 group-[.input-mode]:opacity-100">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <path fill-rule="evenodd" clip-rule="evenodd" d="M12 3C12.2652 3 12.5196 3.10536 12.7071 3.29289L19.7071 10.2929C20.0976 10.6834 20.0976 11.3166 19.7071 11.7071C19.3166 12.0976 18.6834 12.0976 18.2929 11.7071L13 6.41421V20C13 20.5523 12.5523 21 12 21C11.4477 21 11 20.5523 11 20V6.41421L5.70711 11.7071C5.31658 12.0976 4.68342 12.0976 4.29289 11.7071C3.90237 11.3166 3.90237 10.6834 4.29289 10.2929L11.2929 3.29289C11.4804 3.10536 11.7348 3 12 3Z" stroke="currentColor" stroke-width=".5" fill="currentColor"/>
                            </svg> </div>
                        </button>
                    </div>
            
                </div>
                </div>

              <div class="space-y-1 text-left">
                  <label class="block text-xs font-bold text-gray-600 uppercase tracking-wider">Hashtags <span class="text-slate-400 normal-case font-normal">(JSON format)</span></label>
                  <input id="hashtagsGfr" class="w-full p-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-mono text-slate-600 dark:text-slate-300 focus:ring-2 focus:ring-gray-500 focus:border-transparent transition outline-none">
              </div>

              <div class="space-y-1 text-left">
                  <label class="block text-xs font-bold text-gray-600 uppercase tracking-wider">Image Prompt</label>
                  <textarea id="imagePromptGfr" rows="5" class="w-full p-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl text-sm font-mono text-gray-600 dark:text-slate-300 focus:ring-2 focus:ring-gray-500 focus:border-transparent transition outline-none"></textarea>
              </div>
          </div>

          <div class="lg:col-span-4 bg-slate-50 dark:bg-black/20 p-6 sm:p-4 flex flex-col gap-6">
              <div id="imagePreviewGfr" class="flex-1 min-h-[250px] bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden flex items-center justify-center relative shadow-sm group">
              </div>

              <div class="flex flex-col gap-3 mb-[7rem]">
                  <div class="flex items-center justify-between px-2">
                      <div class="text-xs text-gray-600">Status</div>
                      <div id="taskStatusGfr" class="text-xs font-mono text-slate-700 dark:text-slate-300"></div>
                  </div>

                  <button id="btnSaveGfr" class="flex items-center justify-center w-full bg-gray-800 hover:bg-black text-white px-4 py-3 rounded-xl text-sm font-bold transition-all shadow-md">
                      Save
                  </button>

                  <button id="btnRegenGfr" class="hidden flex items-center justify-center w-full border border-slate-300 dark:border-slate-600 hover:bg-white dark:hover:bg-slate-800 text-slate-700 dark:text-slate-200 px-4 py-3 rounded-xl text-sm font-semibold transition-all">
                      Generate Image
                  </button>

                  <div class="h-px bg-slate-200 dark:bg-slate-700 my-1"></div>

                  <button id="btnDeleteGfr" class="flex items-center justify-center w-full text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/10 px-4 py-3 rounded-xl text-sm font-semibold transition-all">
                      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                      Delete Draft
                  </button>
              </div>
          </div>
      </div>
  </div>
</div>


<div id="noti-capsule" class="fixed top-8 left-1/2 -translate-x-1/2 z-50 flex items-center bg-white border border-gray-200 rounded-full shadow-2xl shadow-black/50 opacity-0 -translate-y-10 transition-all duration-500 ease-elastic pointer-events-none">
  <div class="relative w-12 h-12 flex items-center justify-center shrink-0">
      <div id="noti-icon" class="text-gray-800"></div>
  </div>
  <div id="noti-text-wrapper" class="overflow-hidden max-w-0 opacity-0 transition-all duration-500 ease-smooth">
      <div id="noti-message" class="pr-6 pl-1 text-sm font-semibold whitespace-nowrap text-gray-800">
      </div>
  </div>
</div>

<script>
  const content_library_prompts = {
      "Custom Option": "", 
      "Educational Post": "Describe the specific concept, skill, or quick hack you want to teach your audience today, and who the target is.",
      "Marketing Post": "Create a marketing post promoting [insert product/service name] by highlighting the main problem it solves and including a call to action.",
      "Motivational Post": "Generate a motivational post focused on the theme of [insert theme, e.g., resilience, consistency, starting over], and what feeling you want to inspire.",
      "Behind the Scenes (BTS) Post": "Design a post that gives a sneak peek into [describe the process, e.g., our team culture, how we develop our product, a typical day]. What's the main takeaway.",
      "User Generated Content (UGC) Showcase": "Draft a post celebrating a customer who used our product/service. Describe the user's success story and which specific product they used.",
      "Holiday/Seasonal Post": "Create a post recognizing the upcoming holiday/season: [insert holiday/season]. What is the connection to our brand, and what positive message should we convey?",
      "Ask Me Anything (AMA) / Q&A Post": "Formulate a post inviting questions from the audience about [insert topic, e.g., a new feature, industry trends, personal experience]. Clearly state the topic for the Q&A.",
      "Audience Poll/Feedback": "Create a poll or question-based post to get direct feedback on [insert topic, e.g., new product packaging, preferred content type, industry opinion]. What are the choices/options?",
      "Thought Leadership Post": "Develop a strong opinion or unique insight about a recent [industry trend/news item]. What is your contrarian view, and what advice follows from it?",
      "Industry News/Update": "Share a brief update on a recent and relevant piece of industry news. Explain why this news matters to your audience and what their next step should be.",
      "Case Study/Success Story": "Outline a detailed customer success story. Focus on the 'Before' (the problem), the 'During' (how your solution was used), and the 'After' (the measurable result).",
      "Product Feature Spotlight": "Highlight a single, powerful feature of your product: [feature name]. Describe the feature and the single biggest benefit it offers the user.",
      "Contest/Giveaway": "Draft a post announcing a contest or giveaway. Define the prize, the entry rules (e.g., Tag 3 friends, Follow, Share), and the end date.",
      "Flash Sale/Discount": "Write a time-sensitive post announcing a flash sale or discount. Specify the discount percentage, the product, and the expiration date/time."
  };

  // Mapping use case keys to a display text with an emoji
  const useCaseDisplayMapDrf = {
      "Custom Option": "Custom Idea", // Display text for the new option
      "Educational Post": "Educational Post",
      "Marketing Post": "Marketing Post",
      "Motivational Post": "Motivational Post",
      "Behind the Scenes (BTS) Post": "Behind the Scenes (BTS)",
      "User Generated Content (UGC) Showcase": "UGC Showcase",
      "Holiday/Seasonal Post": "Seasonal Post",
      "Ask Me Anything (AMA) / Q&A Post": "AMA / Q&A",
      "Audience Poll/Feedback": "Audience Poll/Feedback",
      "Thought Leadership Post": "Thought Leadership",
      "Industry News/Update": "Industry News",
      "Case Study/Success Story": "Case Study / Success Story",
      "Product Feature Spotlight": "Feature Spotlight",
      "Contest/Giveaway": "Contest / Giveaway",
      "Flash Sale/Discount": "Flash Sale / Discount"
  };

  // --- JAVASCRIPT LOGIC FOR CAROUSEL ---
  document.addEventListener('DOMContentLoaded', function() {
      const promptTextarea = document.getElementById('animatedPlaceholder');
      const prevBtn = document.getElementById('prevCaseBtnDrf');
      const nextBtn = document.getElementById('nextCaseBtnDrf');
      const displayText = document.getElementById('currentCaseTextDrf');
      
      const useCaseKeysDrf = Object.keys(content_library_prompts);
      const totalCasesDrf = useCaseKeysDrf.length;
      let currentCaseIndexDrf = 0; // Starts at Custom Option (index 0)

      // Define a general placeholder for the Custom Option for better UX
      const customPlaceholderDrf = "Describe your idea here... We'll handle the caption, hashtags, and visuals.";

      /**
       * Updates the UI (text display) and the prompt textarea.
       */
      function updateCarouselDrf() {
          const currentKey = useCaseKeysDrf[currentCaseIndexDrf];
          
          // 1. Update Display Text (with emoji)
          displayText.textContent = useCaseDisplayMapDrf[currentKey];
          
          // 2. Conditional Logic for Textarea and Focus
          if (currentKey === "Custom Option") {
              // Clear the content (set value to empty string)
              promptTextarea.value = ''; 
              // Set the informative placeholder
              promptTextarea.placeholder = customPlaceholderDrf; 
              
              // *** REMOVED: promptTextarea.focus(); ***
          } else {
              // For a predefined template, set the prompt and clear the placeholder
              promptTextarea.placeholder = ''; 
              promptTextarea.value = content_library_prompts[currentKey];
              
              // When selecting a new use case template, we might want to focus the field 
              // so the user can immediately edit the [bracketed] text.
              // NOTE: Keeping focus here is generally good practice for template selection.
              promptTextarea.focus(); 
          }
      }

      // Event listener for Next button with Cycling Logic
      nextBtn.addEventListener('click', function() {
          currentCaseIndexDrf = (currentCaseIndexDrf + 1) % totalCasesDrf;
          updateCarouselDrf();
      });

      // Event listener for Previous button with Cycling Logic
      prevBtn.addEventListener('click', function() {
          currentCaseIndexDrf = (currentCaseIndexDrf - 1 + totalCasesDrf) % totalCasesDrf;
          updateCarouselDrf();
      });

      // Initialize the carousel on page load with the Custom Option (no focus)
      updateCarouselDrf();
  });
</script>


<script>
  const toolsMenu = document.getElementById('tools-menu');
  const inputContainer = document.getElementById('input-container');
  const mainBtn = document.getElementById('main-btn');
  const chatInput = document.getElementById('chat-input');
  


  let menuState = {
      menuOpen: false,
      inputMode: false
  };

  async function handleMainClick() {
      if (menuState.inputMode) {
          const userMessage = chatInput.value.trim();
          chatInput.value = "";
          resetToIdle();
          if (userMessage) {
              const captionForFormating = document.getElementById('captionGfr');
              const textToFormat = captionForFormating.value;
              captionForFormating.value = '';
              toggleLoading(`postCaption`, true, 'Updating Caption...');

              try {
                  const response = await fetch('/format-text', {
                      method: 'POST',
                      headers: {
                          'Content-Type': 'application/json',
                      },
                      body: JSON.stringify({
                          text: textToFormat.trim(),
                          custom_instruction: userMessage,
                      })
                  });

                  if (!response.ok) {
                      const errorText = await response.text();
                      throw new Error(`HTTP ${response.status}: ${response.statusText}\n${errorText}`);
                  }

                  const reader = response.body.getReader();
                  const decoder = new TextDecoder();
                  let isFirstChunk = true;

                  while (true) {
                      const { done, value } = await reader.read();
                      if (done) break;

                      const chunk = decoder.decode(value, { stream: true });

                      if (isFirstChunk) {
                          captionForFormating.value = ''; 
                          isFirstChunk = false;
                      }

                      captionForFormating.value += chunk;
                  }
              } catch (err) {
                  console.error("Streaming failed");
                  captionForFormating.value = "Formatting failed. Please try again.";
              }
              finally{
                toggleLoading(`postCaption`, false);

              }
              
          }


      } else {
          toggleMenu();
      }
  }

  function toggleMenu() {
    menuState.menuOpen = !menuState.menuOpen;
      updateUI();
  }

  function activateInputMode() {
    menuState.menuOpen = false; 
    menuState.inputMode = true; 
      updateUI();

  }

  function resetToIdle() {
    menuState.menuOpen = false;
      menuState.inputMode = false;
      updateUI();
  }

  function updateUI() {
      if (menuState.menuOpen) {
          toolsMenu.classList.remove('opacity-0', 'scale-y-50', 'translate-y-10', 'pointer-events-none');
          mainBtn.classList.add('menu-open'); 
      } else {
          toolsMenu.classList.add('opacity-0', 'scale-y-50', 'translate-y-10', 'pointer-events-none');
          mainBtn.classList.remove('menu-open');
      }


      if (menuState.inputMode) {
          inputContainer.classList.remove('w-0', 'opacity-0');
          inputContainer.classList.add('w-auto', 'opacity-100');

          mainBtn.classList.add('input-mode');
      } else {
          inputContainer.classList.add('w-0', 'opacity-0');
          inputContainer.classList.remove('w-auto', 'opacity-100');

          mainBtn.classList.remove('input-mode');
      }
  }

  document.addEventListener('click', (e) => {
      const floatingContainer = document.querySelector('.absolute.bottom-4.right-4.flex');

      if (!floatingContainer.contains(e.target)) {
          if (menuState.inputMode || menuState.menuOpen) {
              if (menuState.inputMode) {
                  chatInput.value = "";
              }
              resetToIdle();
          }
      }
  });

  document.querySelector('.absolute.bottom-4.right-4.flex').addEventListener('click', (e) => {
      e.stopPropagation();
  });
</script>
<script>

  let selectedStyle = null;

  const confirmationModal = `
      <div id="confirm-modal" class="fixed inset-0 bg-black/30 flex items-center justify-center z-[100] hidden">
          <div class="bg-white rounded-3xl p-6 shadow-2xl max-w-md w-full mx-4 animate-in fade-in zoom-in duration-200">
              <h3 class="text-lg font-medium text-gray-800 mb-4">
                  Click cofirm to make the paragraph <span id="style-name" class="text-blue-600"></span>
              </h3>
              <div class="flex gap-3 justify-end mt-3">
                  <button id="cancel-style" class="px-5 py-2.5 bg-gray-100 hover:bg-gray-200 rounded-full font-medium transition">
                      Cancel
                  </button>
                  <button id="confirm-style" class="px-5 py-2.5 bg-gray-800 hover:bg-gray-700 text-white rounded-full font-medium transition">
                      Confirm
                  </button>
              </div>
          </div>
      </div>
  `;
  document.body.insertAdjacentHTML('beforeend', confirmationModal);

  const confirmModal = document.getElementById('confirm-modal');
  const styleNameEl = document.getElementById('style-name');

  document.querySelectorAll('#tools-menu button[name]').forEach(btn => {
      btn.addEventListener('click', (e) => {
          const style = btn.getAttribute('name'); 
          selectedStyle = style;

          styleNameEl.textContent = style;
          confirmModal.classList.remove('hidden');

          if (menuState.menuOpen) {
              menuState.menuOpen = false;
              updateUI();
          }
      });
  });

  document.getElementById('confirm-style').addEventListener('click', async () => {
    if (!selectedStyle) {
        closeModal();
        activateInputMode();
        return;
    }
    const captionForFormating = document.getElementById('captionGfr');
    const textToFormat = captionForFormating.value;
    
    if (!textToFormat.trim()) {
        closeModal();
        activateInputMode();
        return;
    }
    confirmModal.classList.add('hidden');
    activateInputMode();
    toggleLoading(`postCaption`, true, 'Updating Caption...');
    captionForFormating.value = '';

    try {
        const response = await fetch('/format-text', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                text: textToFormat.trim(),
                style: selectedStyle,
            })
        });

        if (!response.ok) {
            const errorText = await response.text();
            throw new Error(`HTTP ${response.status}: ${response.statusText}\n${errorText}`);
        }

        const reader = response.body.getReader();
        const decoder = new TextDecoder();
        let isFirstChunk = true;

        while (true) {
            const { done, value } = await reader.read();
            if (done) break;

            const chunk = decoder.decode(value, { stream: true });

            if (isFirstChunk) {
                captionForFormating.value = ''; // fully clean on first real chunk
                isFirstChunk = false;
            }

            captionForFormating.value += chunk;
        }

    } catch (err) {
        console.error("Streaming failed:", err);
        captionForFormating.value = "Error: Formatting failed. Please try again.";
    }
    finally{
      toggleLoading(`postCaption`, false);
    }
});

  document.getElementById('cancel-style').addEventListener('click', closeModal);

  confirmModal.addEventListener('click', (e) => {
      if (e.target === confirmModal) closeModal();
  });

  function closeModal() {
      console.log("closed");
      confirmModal.classList.add('hidden');
      selectedStyle = null;
  }

  function activateInputMode() {
      menuState.menuOpen = false;
      menuState.inputMode = true;
      updateUI();
      setTimeout(() => chatInput.focus(), 300); 
  }


</script>


<script>

  let animationTimeouts = [];

  const icons = {
      success: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#4ade80" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>`,
      error: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#f87171" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>`,
      warning: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fbbf24" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>`,
      info: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#60a5fa" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>`
  };

  function ShowNoti(type, message) {
      const capsule = document.getElementById('noti-capsule');
      const iconContainer = document.getElementById('noti-icon');
      const textWrapper = document.getElementById('noti-text-wrapper');
      const messageEl = document.getElementById('noti-message');

 
      clearTimeouts();
      
      capsule.classList.add('opacity-0', '-translate-y-10');
      textWrapper.classList.add('max-w-0', 'opacity-0');
      setTimeout(() => {
          // 2. Set Content
          iconContainer.innerHTML = icons[type] || icons['info'];
          messageEl.textContent = message;

          capsule.classList.remove('opacity-0', '-translate-y-10');

          const t1 = setTimeout(() => {
              textWrapper.classList.remove('max-w-0', 'opacity-0');
              textWrapper.classList.add('max-w-[500px]', 'opacity-100'); 
          }, 400);

          const t2 = setTimeout(() => {
              textWrapper.classList.remove('max-w-[500px]', 'opacity-100');
              textWrapper.classList.add('max-w-0', 'opacity-0');
          }, 3000);

          const t3 = setTimeout(() => {
              capsule.classList.add('opacity-0', '-translate-y-10');
          }, 3500);

          animationTimeouts.push(t1, t2, t3);
      }, 50);
  }

  function clearTimeouts() {
      animationTimeouts.forEach(id => clearTimeout(id));
      animationTimeouts = [];
  }
</script>

<script src="/static/placeholderAnim.js" defer></script>
<script src="/static/Tabs.js" ></script>
<script src="/static/PostAi.js"></script>
<script src="/static/plaform.js"></script>
<script src="/static/Scheduled.js"></script>
<script src="/static/Error.js"></script>
</body>
</html>