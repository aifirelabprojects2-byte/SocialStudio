<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Play Style Notification</title>
    <script src="/static/tailwind.js"></script>
    <style>
        .ease-elastic {
            transition-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .ease-smooth {
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center justify-center p-4">

    <!-- UI Controls -->
    <div class="text-center space-y-8 z-10">
        <h1 class="text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-500">
            Capsule Notifications
        </h1>
        <p class="text-gray-400">Click buttons to trigger the animation</p>
        
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full max-w-md mx-auto">
            <button onclick="ShowNoti('success', 'Achievement Unlocked')" 
                class="px-6 py-3 bg-green-600 hover:bg-green-500 rounded-lg shadow-lg transition-all active:scale-95 font-medium">
                Success
            </button>
            
            <button onclick="ShowNoti('error', 'Connection Lost')" 
                class="px-6 py-3 bg-red-600 hover:bg-red-500 rounded-lg shadow-lg transition-all active:scale-95 font-medium">
                Error
            </button>
            
            <button onclick="ShowNoti('warning', 'Low Battery')" 
                class="px-6 py-3 bg-amber-600 hover:bg-amber-500 rounded-lg shadow-lg transition-all active:scale-95 font-medium">
                Warning
            </button>
            
            <button onclick="ShowNoti('info', 'Downloading update...')" 
                class="px-6 py-3 bg-blue-600 hover:bg-blue-500 rounded-lg shadow-lg transition-all active:scale-95 font-medium">
                Info
            </button>
        </div>
    </div>


    <div id="noti-capsule" class="fixed top-8 left-1/2 -translate-x-1/2 z-50 flex items-center bg-slate-200 border border-gray-700 rounded-full shadow-2xl shadow-black/50 opacity-0 -translate-y-10 transition-all duration-500 ease-elastic pointer-events-none">
        <div class="relative w-12 h-12 flex items-center justify-center shrink-0">
            <div id="noti-icon" class="text-gray-800"></div>
        </div>
        <div id="noti-text-wrapper" class="overflow-hidden max-w-0 opacity-0 transition-all duration-500 ease-smooth">
            <div id="noti-message" class="pr-6 pl-1 text-sm font-semibold whitespace-nowrap text-gray-800">
            </div>
        </div>
    </div>

    <script>

        let animationTimeouts = [];

        const icons = {
            success: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#4ade80" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>`,
            error: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#f87171" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>`,
            warning: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fbbf24" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>`,
            info: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#60a5fa" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>`
        };

        function ShowNoti(type, message) {
            const capsule = document.getElementById('noti-capsule');
            const iconContainer = document.getElementById('noti-icon');
            const textWrapper = document.getElementById('noti-text-wrapper');
            const messageEl = document.getElementById('noti-message');

            // 1. Reset Animation State (in case one is running)
            clearTimeouts();
            
            // Immediately hide to reset if mid-animation
            capsule.classList.add('opacity-0', '-translate-y-10');
            textWrapper.classList.add('max-w-0', 'opacity-0');
            
            // Small delay to allow DOM to register the reset class application
            setTimeout(() => {
                // 2. Set Content
                iconContainer.innerHTML = icons[type] || icons['info'];
                messageEl.textContent = message;

                // 3. Start Animation Sequence

                // Step A: Drop down and Fade In (Icon only)
                capsule.classList.remove('opacity-0', '-translate-y-10');
                
                // Step B: Expand to show text (after 400ms)
                const t1 = setTimeout(() => {
                    textWrapper.classList.remove('max-w-0', 'opacity-0');
                    textWrapper.classList.add('max-w-[500px]', 'opacity-100'); // Large max-width to accommodate text
                }, 400);

                // Step C: Collapse text (after 3000ms)
                const t2 = setTimeout(() => {
                    textWrapper.classList.remove('max-w-[500px]', 'opacity-100');
                    textWrapper.classList.add('max-w-0', 'opacity-0');
                }, 3000);

                // Step D: Fade out and move up (after 3500ms)
                const t3 = setTimeout(() => {
                    capsule.classList.add('opacity-0', '-translate-y-10');
                }, 3500);

                animationTimeouts.push(t1, t2, t3);
            }, 50);
        }

        function clearTimeouts() {
            animationTimeouts.forEach(id => clearTimeout(id));
            animationTimeouts = [];
        }
    </script>
</body>
</html>